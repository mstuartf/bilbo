<mat-card-header class="home-card-header">

	<mat-card-title>My Bills</mat-card-title>

  	<div class="date-filter-buttons">

  		<button *ngIf="!dateFilter" mat-icon-button (click)="selectFilterDate()" [disabled]="showNewSpinner || !dataSource">
	    	<mat-icon>filter_list</mat-icon>
	  	</button>

	  	<button *ngIf="dateFilter" mat-stroked-button (click)="removeFilterDate()" [disabled]="showNewSpinner || !dataSource">
	    	due on {{ dateFilter | date: 'dd/MM/yyyy' }}
	    	<mat-icon class="small-mat-icon">close</mat-icon>
	  	</button>

  	</div>

    <a
      routerLink="/internal/settings"
      [class.disabled]="showNewSpinner || !dataSource"
      mat-button color="primary">
      Settings
    </a>

</mat-card-header>

<mat-card-content class="home-card-content">

  <table mat-table matSort [dataSource]="dataSource" class="home-table">

  	<ng-container matColumnDef="title">
	  <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
	  <td mat-cell *matCellDef="let bill" data-label="Name"> {{bill.title}} </td>
	  <td mat-footer-cell *matFooterCellDef>
	  	Total<span *ngIf="!dateFilter">*</span>
	  </td>
	</ng-container>

  	<ng-container matColumnDef="periodFrequency">
	  <th mat-header-cell *matHeaderCellDef mat-sort-header>Every</th>
	  <td mat-cell *matCellDef="let bill" data-label="Every"> {{bill.periodFrequency}} </td>
	  <td mat-footer-cell *matFooterCellDef></td>
	</ng-container>

  	<ng-container matColumnDef="period">
	  <th mat-header-cell *matHeaderCellDef mat-sort-header>Period</th>
	  <td mat-cell *matCellDef="let bill" data-label="Period"> {{bill.period}} </td>
	  <td mat-footer-cell *matFooterCellDef></td>
	</ng-container>

  	<ng-container matColumnDef="firstPaymentDate">
	  <th mat-header-cell *matHeaderCellDef mat-sort-header>Starting from</th>
	  <td mat-cell *matCellDef="let bill" data-label="Starting from"> {{bill.firstPaymentDate | date: 'dd/MM/yyyy'}} </td>
	  <td mat-footer-cell *matFooterCellDef></td>
	</ng-container>

  	<ng-container matColumnDef="amount">
	  <th mat-header-cell *matHeaderCellDef mat-sort-header> Amount </th>
	  <td mat-cell *matCellDef="let bill" data-label="Amount"> {{ bill.amount | currency: '£' }} </td>
	  <td mat-footer-cell *matFooterCellDef> {{ periodSum | currency: '£' }} </td>
	</ng-container>

  	<ng-container matColumnDef="remove">
	  <th mat-header-cell *matHeaderCellDef></th>
	  <td mat-cell *matCellDef="let bill">
	  	<div class="mat-cell-inner">
	  		<button mat-icon-button (click)="removeBill(bill)" [disabled]="showNewSpinner">
		    	<mat-icon>delete_outline</mat-icon>
		  	</button>
	  	</div>
	  </td>
	  <td mat-footer-cell *matFooterCellDef></td>
	</ng-container>

	<tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
	<tr mat-row *matRowDef="let row; columns: columnsToDisplay"></tr>
	<tr mat-footer-row *matFooterRowDef="billFeed && billFeed.monthlyTotal ? columnsToDisplay : []"></tr>

  </table>

  <div *ngIf="!dataSource" class="mat-spinner-container">
     <mat-spinner diameter="50"></mat-spinner>
  </div>

</mat-card-content>

<mat-card-footer class="home-card-footer">

	<div class="d-flex items-center">
		<p *ngIf="dataSource && !dateFilter" 
			class="mat-small">
			*{{periodCount}} payment<span *ngIf="periodCount!==1">s</span>
			for 
			{{billFeed.list.length}} bill<span *ngIf="billFeed.list.length!==1">s</span>
			due between 
			{{lastSalaryDate | date: 'dd/MM/yyyy'}}
			and
			{{nextSalaryDate | date: 'dd/MM/yyyy'}}
	  	</p>
	</div>

	<div class="d-flex items-center">

		<div class="small-mat-spinner-container">
    		<mat-spinner diameter="30" *ngIf="showNewSpinner"></mat-spinner>
    	</div>

	    <button
	      id="newBillButton"
	      (click)="addBill()"
	      [disabled]="showNewSpinner || !dataSource"
	      mat-raised-button color="primary">
	      + New Bill
	    </button>

	</div>

</mat-card-footer>
